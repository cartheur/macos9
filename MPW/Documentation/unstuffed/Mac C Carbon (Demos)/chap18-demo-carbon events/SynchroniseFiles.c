// *******************************************************************************************// SynchroniseFiles.c// *******************************************************************************************// ииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии includes#include "Files.h"// ииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииииии global variablesextern SInt16	gCurrentNumberOfWindows;// ************************************************************************ doSynchroniseFilesvoid  doSynchroniseFiles(void){	WindowRef						windowRef;	SInt16							trashVRefNum;	SInt32							trashDirID;	docStructureHandle	docStrucHdl;	Boolean							aliasChanged;	AliasHandle					aliasHdl;	FSSpec							newFSSpec;	OSErr								osError;	windowRef = FrontNonFloatingWindow();	while(windowRef != NULL)	{		docStrucHdl = (docStructureHandle) GetWRefCon(windowRef);		if(docStrucHdl != NULL)		{			if((*docStrucHdl)->aliasHdl == NULL)				break;			aliasChanged = false;			aliasHdl = (*docStrucHdl)->aliasHdl;			ResolveAlias(NULL,aliasHdl,&newFSSpec,&aliasChanged);			if(aliasChanged)			{				(*docStrucHdl)->fileFSSpec = newFSSpec;				SetWTitle(windowRef,newFSSpec.name);			}			osError = FindFolder(kUserDomain,kTrashFolderType,kDontCreateFolder,&trashVRefNum,													 &trashDirID);			if(osError == noErr)			{				do				{					if(newFSSpec.parID == fsRtParID)						break;					if((newFSSpec.vRefNum == trashVRefNum) && (newFSSpec.parID == trashDirID))					{						FSClose((*docStrucHdl)->fileRefNum);						if((*docStrucHdl)->editStrucHdl)							TEDispose((*docStrucHdl)->editStrucHdl);						if((*docStrucHdl)->pictureHdl)							KillPicture((*docStrucHdl)->pictureHdl);						DisposeHandle((Handle) docStrucHdl);						DisposeWindow(windowRef);						gCurrentNumberOfWindows --;						break;					}				} while(FSMakeFSSpec(newFSSpec.vRefNum,newFSSpec.parID,"\p",&newFSSpec) == noErr);			}		}		windowRef = GetNextWindow(windowRef);	}}// *******************************************************************************************