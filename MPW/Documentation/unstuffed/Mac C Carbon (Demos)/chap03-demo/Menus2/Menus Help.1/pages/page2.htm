<html><head><title>Creating and handling a Mac OS X Help menu</title><meta name = "DESCRIPTION" CONTENT="This section describes how to create and handle a Mac OS X Help menu."></head><body bgcolor="white"><table border="0" cellpadding="0" cellspacing="0" width="365"><tr valign="top"><td><font face="Helvetica,Arial" size="4" color="#000066"><b>CREATING AND HANDLING A MAC OS X HELP MENU</b></font><ul><p><font face="Geneva,Arial" size="2">The following applies to Mac OS X only.</font></ul></td></tr><tr valign="top"><td><font face="Helvetica,Arial" size="4" color="#000066"><b>1 - Creating the Help Menu</b></font><ul><p><font face="Geneva,Arial" size="2">You can create your Help menu using the function <font color="#993333"><tt>HMGetHelpMenu</tt></font color>, insert a help item in the menu using the function <font color="#993333"><tt>InsertMenuItem</tt></font color> and assign a command ID to that item using the function <font color="#993333"><tt>SetMenuItemCommandID</tt></font color>.  For example:</font><font size="1"><font color="#993333"><pre>&nbsp; MenuRef menuRef;  if(gRunningOnX)  {    HMGetHelpMenu(&amp;menuRef,NULL);    InsertMenuItem(menuRef,"\pMenus Help",0);    SetMenuItemCommandID(menuRef,1,'help');  }</pre></font size></font color></ul></td></tr><tr valign="top"><td><font face="Helvetica,Arial" size="4" color="#000066"><b>2 - Handling the Help Menu</b></font><ul><p><font face="Geneva,Arial" size="2">When the user chooses the help item in the Help menu, you can call the Apple Help function <font color="#993333"><tt>AHGotoPage</tt></font color>, which delivers a request to load a specific text/html file to the Help Viewer application.</font> <p><font face="Geneva,Arial" size="2"> The following example assumes that your <B>Help book folder</B> (see Creating a Title Page), or an alias to it, is placed in ~/Library/Preferences/Apple Help Prefs/.  The title of your Help book is passed in the first parameter of the <font color="#993333"><tt>AHGotoPage</tt></font color> call and the name of the file containing your <b>title page</b> (see Creating a Title Page) is passed in the second parameter:</font><font size="1"><font color="#993333"><pre>&nbsp; switch(commandID)  {    case 'help':      AHGotoPage(CFSTR("Menus Help"),                 CFSTR("Menus.htm"),NULL);      break;  }</pre></font size></font color></ul></td></tr></table><table border="0" cellpadding="0" cellspacing="0" width="365"><tr><td><hr></td></tr><tr><td align="center"><a href="../Menus.htm"><font face="Geneva" size="1">Back to Contents</font></a> </td></tr></table><p></body></html>